!function(){"use strict";window;var t,e={i8:"i8",ui8:"ui8",ui8c:"ui8c",i16:"i16",ui16:"ui16",i32:"i32",ui32:"ui32",f32:"f32",f64:"f64",eid:"eid"},i={i8:"Int8",ui8:"Uint8",ui8c:"Uint8Clamped",i16:"Int16",ui16:"Uint16",i32:"Int32",ui32:"Uint32",eid:"Uint32",f32:"Float32",f64:"Float64"},s={i8:Int8Array,ui8:Uint8Array,ui8c:Uint8ClampedArray,i16:Int16Array,ui16:Uint16Array,i32:Int32Array,ui32:Uint32Array,f32:Float32Array,f64:Float64Array,eid:Uint32Array},n=256,o=65536,r=(t=4,e=>Math.ceil(e/t)*t),a=Symbol("storeRef"),l=Symbol("storeSize"),h=Symbol("storeMaps"),c=Symbol("storeFlattened"),u=Symbol("storeBase"),d=Symbol("storeType"),f=Symbol("storeArrayElementCounts"),g=Symbol("storeSubarrays"),p=Symbol("subarrayCursors"),_=Symbol("subarray"),m=Symbol("parentArray"),y=Symbol("tagStore"),b=Symbol("indexType"),w=Symbol("indexBytes"),S=Symbol("isEidType"),v={},x=(t,e)=>{const i=new ArrayBuffer(e*t.BYTES_PER_ELEMENT),s=new t.constructor(i);return s.set(t,0),s},E=(t,a,l)=>{Object.keys(a).forEach((h=>{const u=a[h];Array.isArray(u)?(((t,a,l)=>{const h=t[p];let c=a[d];const u=a[0].length,y=u<=n?e.ui8:u<=o?e.ui16:e.ui32;if(0===h[c]){const e=t[f][c],n=new s[c](r(e*l));n.set(t[g][c]),t[g][c]=n,n[b]=i[y],n[w]=s[y].BYTES_PER_ELEMENT}const S=h[c],v=S+l*u;h[c]=v,a[m]=t[g][c].subarray(S,v);for(let t=0;t<l;t++){const e=u*t,n=e+u;a[t]=a[m].subarray(e,n),a[t][b]=i[y],a[t][w]=s[y].BYTES_PER_ELEMENT,a[t][_]=!0}})(t,u,l),a[c].push(u)):ArrayBuffer.isView(u)?(a[h]=x(u,l),a[c].push(a[h])):"object"==typeof u&&E(t,a[h],l)}))},T=(t,e)=>{t[y]||(t[l]=e,t[c].length=0,Object.keys(t[p]).forEach((e=>{t[p][e]=0})),E(t,t,e))},M=(t,e)=>{t[c]&&t[c].forEach((t=>{ArrayBuffer.isView(t)?t[e]=0:t[e].fill(0)}))},k=t=>Array.isArray(t)&&"string"==typeof t[0]&&"number"==typeof t[1],A=(t,x)=>{const E=Symbol("store");if(!t||!Object.keys(t).length)return v[E]={[l]:x,[y]:!0,[u]:()=>v[E]},v[E];t=JSON.parse(JSON.stringify(t));const T={},M=t=>{const e=Object.keys(t);for(const i of e)k(t[i])?(T[t[i][0]]||(T[t[i][0]]=0),T[t[i][0]]+=t[i][1]):t[i]instanceof Object&&M(t[i])};M(t);const A={[l]:x,[h]:{},[g]:{},[a]:E,[p]:Object.keys(s).reduce(((t,e)=>({...t,[e]:0})),{}),[c]:[],[f]:T};if(t instanceof Object&&Object.keys(t).length){const a=(t,h)=>{if("string"==typeof t[h])t[h]=((t,i)=>{const n=i*s[t].BYTES_PER_ELEMENT,o=new ArrayBuffer(n),r=new s[t](o);return r[S]=t===e.eid,r})(t[h],x),t[h][u]=()=>v[E],A[c].push(t[h]);else if(k(t[h])){const[a,y]=t[h];t[h]=((t,a,h)=>{const c=t[l],u=Array(c).fill(0);u[d]=a,u[S]=a===e.eid;const y=t[p],v=h<=n?e.ui8:h<=o?e.ui16:e.ui32;if(!h)throw new Error("bitECS - Must define component array length");if(!s[a])throw new Error(`bitECS - Invalid component array property type ${a}`);if(!t[g][a]){const e=t[f][a],n=new s[a](r(e*c));n[b]=i[v],n[w]=s[v].BYTES_PER_ELEMENT,t[g][a]=n}const x=y[a],E=x+c*h;y[a]=E,u[m]=t[g][a].subarray(x,E);for(let t=0;t<c;t++){const e=h*t,n=e+h;u[t]=u[m].subarray(e,n),u[t][b]=i[v],u[t][w]=s[v].BYTES_PER_ELEMENT,u[t][_]=!0}return u})(A,a,y),t[h][u]=()=>v[E],A[c].push(t[h])}else t[h]instanceof Object&&(t[h]=Object.keys(t[h]).reduce(a,t[h]));return t};return v[E]=Object.assign(Object.keys(t).reduce(a,t),A),v[E][u]=()=>v[E],v[E]}},C=()=>{const t=[],e=[];t.sort=function(i){const s=Array.prototype.sort.call(this,i);for(let i=0;i<t.length;i++)e[t[i]]=i;return s};const i=i=>t[e[i]]===i;return{add:s=>{i(s)||(e[s]=t.push(s)-1)},remove:s=>{if(!i(s))return;const n=e[s],o=t.pop();o!==s&&(t[n]=o,e[o]=n)},has:i,sparse:e,dense:t}},R=Symbol("entityMasks"),P=Symbol("entityComponents"),z=Symbol("entitySparseSet"),O=Symbol("entityArray"),I=1e5,U=0,X=I,F=()=>X,B=[],L=t=>{const e=X;X=I=t,U=0,B.length=0,X=t,bt(t),rt(t),console.info(`ðŸ‘¾ bitECS - resizing all data stores from ${e} to ${t}`)},q=new Map,N=t=>{if(U>=X-X/5){const t=X,e=4*Math.ceil(t/2/4);L(t+e)}const e=B.length>Math.round(.01*I)?B.shift():U++;return t[z].add(e),q.set(e,t),t[Y].forEach((i=>{Z(t,i,e)&&tt(i,e)})),t[P].set(e,new Set),e},W=Symbol("queries"),Y=Symbol("notQueries"),$=Symbol("queryAny"),j=Symbol("queryAll"),D=Symbol("queryNone"),H=Symbol("queryMap"),G=Symbol("$dirtyQueries"),V=Symbol("queryComponents"),Q=(t,e)=>{const i=[],s=[],n=[];e[V].forEach((e=>{if("function"==typeof e){const[o,r]=e();t[nt].has(o)||lt(t,o),"not"===r&&s.push(o),"changed"===r&&(n.push(o),i.push(o))}else t[nt].has(e)||lt(t,e),i.push(e)}));const o=e=>t[nt].get(e),r=i.concat(s).map(o),a=C(),l=C(),h=C(),u=C(),d=r.map((t=>t.generationId)).reduce(((t,e)=>(t.includes(e)||t.push(e),t)),[]),f=(t,e)=>(t[e.generationId]||(t[e.generationId]=0),t[e.generationId]|=e.bitflag,t),g=i.map(o).reduce(f,{}),p=s.map(o).reduce(f,{}),_=r.reduce(f,{}),m=i.filter((t=>!t[y])).map((t=>Object.getOwnPropertySymbols(t).includes(c)?t[c]:[t])).reduce(((t,e)=>t.concat(e)),[]),b=Object.assign(a,{archetypes:[],changed:[],components:i,notComponents:s,changedComponents:n,allComponents:r,masks:g,notMasks:p,hasMasks:_,generations:d,flatProps:m,toRemove:l,entered:h,exited:u,shadows:[]});t[H].set(e,b),t[W].add(b),r.forEach((t=>{t.queries.add(b)})),s.length&&t[Y].add(b);for(let e=0;e<U;e++){if(!t[z].has(e))continue;Z(t,b,e)&&tt(b,e)}},J=(t,e)=>{const i=Symbol(),s=t.flatProps[e];return((t,e)=>{if(ArrayBuffer.isView(t))t[e]=t.slice(0);else{const i=t[m].slice(0);t[e]=t.map(((e,s)=>{const{length:n}=t[s],o=n*s,r=o+n;return i.subarray(o,r)}))}})(s,i),t.shadows[e]=s[i],s[i]},K=(...t)=>{let e;if(Array.isArray(t[0])&&(e=t[0]),void 0===e||void 0!==e[nt])return t=>t?t[O]:e[O];const i=function(t,e=!0){t[H].has(i)||Q(t,i);const s=t[H].get(i);return it(t),s.changedComponents.length?((t,e)=>{e&&(t.changed=[]);const{flatProps:i,shadows:s}=t;for(let e=0;e<t.dense.length;e++){const n=t.dense[e];let o=!1;for(let e=0;e<i.length;e++){const r=i[e],a=s[e]||J(t,e);if(ArrayBuffer.isView(r[n])){for(let t=0;t<r[n].length;t++)if(r[n][t]!==a[n][t]){o=!0;break}a[n].set(r[n])}else r[n]!==a[n]&&(o=!0,a[n]=r[n])}o&&t.changed.push(n)}return t.changed})(s,e):s.dense};return i[V]=e,i[$]=undefined,i[j]=undefined,i[D]=undefined,i},Z=(t,e,i)=>{const{masks:s,notMasks:n,generations:o}=e;for(let e=0;e<o.length;e++){const r=o[e],a=s[r],l=n[r],h=t[R][r][i];if(l&&0!=(h&l))return!1;if(a&&(h&a)!==a)return!1}return!0},tt=(t,e)=>{t.toRemove.remove(e),t.entered.add(e),t.add(e)},et=t=>{for(let e=t.toRemove.dense.length-1;e>=0;e--){const i=t.toRemove.dense[e];t.toRemove.remove(i),t.remove(i)}},it=t=>{t[G].size&&(t[G].forEach(et),t[G].clear())},st=(t,e,i)=>{e.has(i)&&!e.toRemove.has(i)&&(e.toRemove.add(i),t[G].add(e),e.exited.add(i))},nt=Symbol("componentMap"),ot=[],rt=t=>{ot.forEach((e=>T(e,t)))},at=(t,e)=>{const i=A(t,e||F());return t&&Object.keys(t).length&&ot.push(i),i},lt=(t,e)=>{if(!e)throw new Error("bitECS - Cannot register null or undefined component");const i=new Set,s=new Set,n=new Set;t[W].forEach((t=>{t.allComponents.includes(e)&&i.add(t)})),t[nt].set(e,{generationId:t[R].length-1,bitflag:t[gt],store:e,queries:i,notQueries:s,changedQueries:n}),e[l]<F()&&T(e,F()),(t=>{t[gt]*=2,t[gt]>=2**31&&(t[gt]=1,t[R].push(new Uint32Array(t[dt])))})(t)},ht=(t,e,i)=>{const s=t[nt].get(e);if(!s)return!1;const{generationId:n,bitflag:o}=s;return(t[R][n][i]&o)===o},ct=(t,e,i,s=!1)=>{if(void 0===i)throw new Error("bitECS - entity is undefined.");if(!t[z].has(i))throw new Error("bitECS - entity does not exist in the world.");if(t[nt].has(e)||lt(t,e),ht(t,e,i))return;const n=t[nt].get(e),{generationId:o,bitflag:r,queries:a,notQueries:l}=n;t[R][o][i]|=r,a.forEach((e=>{e.toRemove.has(i)&&e.toRemove.remove(i);const s=Z(t,e,i);s&&tt(e,i),s||st(t,e,i)})),t[P].get(i).add(e),s&&M(e,i)},ut=(t,e,i,s=!0)=>{if(void 0===i)throw new Error("bitECS - entity is undefined.");if(!t[z].has(i))throw new Error("bitECS - entity does not exist in the world.");if(!ht(t,e,i))return;const n=t[nt].get(e),{generationId:o,bitflag:r,queries:a}=n;t[R][o][i]&=~r,a.forEach((e=>{e.toRemove.has(i)&&e.toRemove.remove(i);const s=Z(t,e,i);s&&tt(e,i),s||st(t,e,i)})),t[P].get(i).delete(e),s&&M(e,i)},dt=Symbol("size"),ft=Symbol("resizeThreshold"),gt=Symbol("bitflag"),pt=Symbol("archetypes"),_t=Symbol("localEntities"),mt=Symbol("localEntityLookp"),yt=[],bt=t=>{yt.forEach((e=>{e[dt]=t;for(let i=0;i<e[R].length;i++){const s=e[R][i];e[R][i]=x(s,t)}e[ft]=e[dt]-e[dt]/5}))},wt=(t,e=F())=>(t[dt]=e,t[O]&&t[O].forEach((e=>((t,e)=>{if(t[z].has(e)){t[W].forEach((i=>{st(t,i,e)})),B.push(e),t[z].remove(e),t[P].delete(e),t[_t].delete(t[mt].get(e)),t[mt].delete(e);for(let i=0;i<t[R].length;i++)t[R][i][e]=0}})(t,e))),t[R]=[new Uint32Array(e)],t[P]=new Map,t[pt]=[],t[z]=C(),t[O]=t[z].dense,t[gt]=1,t[nt]=new Map,t[H]=new Map,t[W]=new Set,t[Y]=new Set,t[G]=new Set,t[_t]=new Map,t[mt]=new Map,t),St=e;const vt=at(),xt=at({x:St.ui16,y:St.ui16}),Et=Math.floor(30)-Math.floor(15),Tt=Math.floor(20)-Math.floor(10),Mt=at({selectX:St.i16,selectY:St.i16}),kt=2.3283064365386963e-10;class At{constructor(){this._seed=0,this._s0=0,this._s1=0,this._s2=0,this._c=0}getSeed(){return this._seed}setSeed(t){return t=t<1?1/t:t,this._seed=t,this._s0=(t>>>0)*kt,t=69069*t+1>>>0,this._s1=t*kt,t=69069*t+1>>>0,this._s2=t*kt,this._c=1,this}getUniform(){let t=2091639*this._s0+this._c*kt;return this._s0=this._s1,this._s1=this._s2,this._c=0|t,this._s2=t-this._c,this._s2}getUniformInt(t,e){let i=Math.max(t,e),s=Math.min(t,e);return Math.floor(this.getUniform()*(i-s+1))+s}getNormal(t=0,e=1){let i,s,n;do{i=2*this.getUniform()-1,s=2*this.getUniform()-1,n=i*i+s*s}while(n>1||0==n);return t+i*Math.sqrt(-2*Math.log(n)/n)*e}getPercentage(){return 1+Math.floor(100*this.getUniform())}getItem(t){return t.length?t[Math.floor(this.getUniform()*t.length)]:null}shuffle(t){let e=[],i=t.slice();for(;i.length;){let t=i.indexOf(this.getItem(i));e.push(i.splice(t,1)[0])}return e}getWeightedValue(t){let e=0;for(let i in t)e+=t[i];let i,s=this.getUniform()*e,n=0;for(i in t)if(n+=t[i],s<n)return i;return i}getState(){return[this._s0,this._s1,this._s2,this._c]}setState(t){return this._s0=t[0],this._s1=t[1],this._s2=t[2],this._c=t[3],this}clone(){return(new At).setState(this.getState())}}var Ct=(new At).setSeed(Date.now());class Rt{getContainer(){return null}setOptions(t){this._options=t}}class Pt extends Rt{constructor(){super(),this._ctx=document.createElement("canvas").getContext("2d")}schedule(t){requestAnimationFrame(t)}getContainer(){return this._ctx.canvas}setOptions(t){super.setOptions(t);const e=`${t.fontStyle?`${t.fontStyle} `:""} ${t.fontSize}px ${t.fontFamily}`;this._ctx.font=e,this._updateSize(),this._ctx.font=e,this._ctx.textAlign="center",this._ctx.textBaseline="middle"}clear(){this._ctx.fillStyle=this._options.bg,this._ctx.fillRect(0,0,this._ctx.canvas.width,this._ctx.canvas.height)}eventToPosition(t,e){let i=this._ctx.canvas,s=i.getBoundingClientRect();return t-=s.left,e-=s.top,t*=i.width/s.width,e*=i.height/s.height,t<0||e<0||t>=i.width||e>=i.height?[-1,-1]:this._normalizedEventToPosition(t,e)}}function zt(t,e){return(t%e+e)%e}class Ot extends Pt{constructor(){super(),this._spacingX=0,this._spacingY=0,this._hexSize=0}draw(t,e){let[i,s,n,o,r]=t,a=[(i+1)*this._spacingX,s*this._spacingY+this._hexSize];if(this._options.transpose&&a.reverse(),e&&(this._ctx.fillStyle=r,this._fill(a[0],a[1])),!n)return;this._ctx.fillStyle=o;let l=[].concat(n);for(let t=0;t<l.length;t++)this._ctx.fillText(l[t],a[0],Math.ceil(a[1]))}computeSize(t,e){return this._options.transpose&&(t+=e,t-=e=t-e),[Math.floor(t/this._spacingX)-1,Math.floor((e-2*this._hexSize)/this._spacingY+1)]}computeFontSize(t,e){this._options.transpose&&(t+=e,t-=e=t-e);let i=2*t/((this._options.width+1)*Math.sqrt(3))-1,s=e/(2+1.5*(this._options.height-1)),n=Math.min(i,s),o=this._ctx.font;this._ctx.font="100px "+this._options.fontFamily;let r=Math.ceil(this._ctx.measureText("W").width);this._ctx.font=o;let a=r/100;n=Math.floor(n)+1;let l=2*n/(this._options.spacing*(1+a/Math.sqrt(3)));return Math.ceil(l)-1}_normalizedEventToPosition(t,e){let i;this._options.transpose?(t+=e,t-=e=t-e,i=this._ctx.canvas.width):i=this._ctx.canvas.height;let s=i/this._options.height;return zt(e=Math.floor(e/s),2)?(t-=this._spacingX,t=1+2*Math.floor(t/(2*this._spacingX))):t=2*Math.floor(t/(2*this._spacingX)),[t,e]}_fill(t,e){let i=this._hexSize,s=this._options.border;const n=this._ctx;n.beginPath(),this._options.transpose?(n.moveTo(t-i+s,e),n.lineTo(t-i/2+s,e+this._spacingX-s),n.lineTo(t+i/2-s,e+this._spacingX-s),n.lineTo(t+i-s,e),n.lineTo(t+i/2-s,e-this._spacingX+s),n.lineTo(t-i/2+s,e-this._spacingX+s),n.lineTo(t-i+s,e)):(n.moveTo(t,e-i+s),n.lineTo(t+this._spacingX-s,e-i/2+s),n.lineTo(t+this._spacingX-s,e+i/2-s),n.lineTo(t,e+i-s),n.lineTo(t-this._spacingX+s,e+i/2-s),n.lineTo(t-this._spacingX+s,e-i/2+s),n.lineTo(t,e-i+s)),n.fill()}_updateSize(){const t=this._options,e=Math.ceil(this._ctx.measureText("W").width);let i,s;this._hexSize=Math.floor(t.spacing*(t.fontSize+e/Math.sqrt(3))/2),this._spacingX=this._hexSize*Math.sqrt(3)/2,this._spacingY=1.5*this._hexSize,t.transpose?(i="height",s="width"):(i="width",s="height"),this._ctx.canvas[i]=Math.ceil((t.width+1)*this._spacingX),this._ctx.canvas[s]=Math.ceil((t.height-1)*this._spacingY+2*this._hexSize)}}let It=(()=>{class t extends Pt{constructor(){super(),this._spacingX=0,this._spacingY=0,this._canvasCache={}}setOptions(t){super.setOptions(t),this._canvasCache={}}draw(e,i){t.cache?this._drawWithCache(e):this._drawNoCache(e,i)}_drawWithCache(t){let e,[i,s,n,o,r]=t,a=""+n+o+r;if(a in this._canvasCache)e=this._canvasCache[a];else{let t=this._options.border;e=document.createElement("canvas");let i=e.getContext("2d");if(e.width=this._spacingX,e.height=this._spacingY,i.fillStyle=r,i.fillRect(t,t,e.width-t,e.height-t),n){i.fillStyle=o,i.font=this._ctx.font,i.textAlign="center",i.textBaseline="middle";let t=[].concat(n);for(let e=0;e<t.length;e++)i.fillText(t[e],this._spacingX/2,Math.ceil(this._spacingY/2))}this._canvasCache[a]=e}this._ctx.drawImage(e,i*this._spacingX,s*this._spacingY)}_drawNoCache(t,e){let[i,s,n,o,r]=t;if(e){let t=this._options.border;this._ctx.fillStyle=r,this._ctx.fillRect(i*this._spacingX+t,s*this._spacingY+t,this._spacingX-t,this._spacingY-t)}if(!n)return;this._ctx.fillStyle=o;let a=[].concat(n);for(let t=0;t<a.length;t++)this._ctx.fillText(a[t],(i+.5)*this._spacingX,Math.ceil((s+.5)*this._spacingY))}computeSize(t,e){return[Math.floor(t/this._spacingX),Math.floor(e/this._spacingY)]}computeFontSize(t,e){let i=Math.floor(t/this._options.width),s=Math.floor(e/this._options.height),n=this._ctx.font;this._ctx.font="100px "+this._options.fontFamily;let o=Math.ceil(this._ctx.measureText("W").width);this._ctx.font=n;let r=o/100*s/i;return r>1&&(s=Math.floor(s/r)),Math.floor(s/this._options.spacing)}_normalizedEventToPosition(t,e){return[Math.floor(t/this._spacingX),Math.floor(e/this._spacingY)]}_updateSize(){const t=this._options,e=Math.ceil(this._ctx.measureText("W").width);this._spacingX=Math.ceil(t.spacing*e),this._spacingY=Math.ceil(t.spacing*t.fontSize),t.forceSquareRatio&&(this._spacingX=this._spacingY=Math.max(this._spacingX,this._spacingY)),this._ctx.canvas.width=t.width*this._spacingX,this._ctx.canvas.height=t.height*this._spacingY}}return t.cache=!1,t})();class Ut extends Pt{constructor(){super(),this._colorCanvas=document.createElement("canvas")}draw(t,e){let[i,s,n,o,r]=t,a=this._options.tileWidth,l=this._options.tileHeight;if(e&&(this._options.tileColorize?this._ctx.clearRect(i*a,s*l,a,l):(this._ctx.fillStyle=r,this._ctx.fillRect(i*a,s*l,a,l))),!n)return;let h=[].concat(n),c=[].concat(o),u=[].concat(r);for(let t=0;t<h.length;t++){let e=this._options.tileMap[h[t]];if(!e)throw new Error(`Char "${h[t]}" not found in tileMap`);if(this._options.tileColorize){let n=this._colorCanvas,o=n.getContext("2d");o.globalCompositeOperation="source-over",o.clearRect(0,0,a,l);let r=c[t],h=u[t];o.drawImage(this._options.tileSet,e[0],e[1],a,l,0,0,a,l),"transparent"!=r&&(o.fillStyle=r,o.globalCompositeOperation="source-atop",o.fillRect(0,0,a,l)),"transparent"!=h&&(o.fillStyle=h,o.globalCompositeOperation="destination-over",o.fillRect(0,0,a,l)),this._ctx.drawImage(n,i*a,s*l,a,l)}else this._ctx.drawImage(this._options.tileSet,e[0],e[1],a,l,i*a,s*l,a,l)}}computeSize(t,e){return[Math.floor(t/this._options.tileWidth),Math.floor(e/this._options.tileHeight)]}computeFontSize(){throw new Error("Tile backend does not understand font size")}_normalizedEventToPosition(t,e){return[Math.floor(t/this._options.tileWidth),Math.floor(e/this._options.tileHeight)]}_updateSize(){const t=this._options;this._ctx.canvas.width=t.width*t.tileWidth,this._ctx.canvas.height=t.height*t.tileHeight,this._colorCanvas.width=t.tileWidth,this._colorCanvas.height=t.tileHeight}}function Xt(t){let e,i;if(t in Ft)e=Ft[t];else{if("#"==t.charAt(0)){let i=(t.match(/[0-9a-f]/gi)||[]).map((t=>parseInt(t,16)));if(3==i.length)e=i.map((t=>17*t));else{for(let t=0;t<3;t++)i[t+1]+=16*i[t],i.splice(t,1);e=i}}else e=(i=t.match(/rgb\(([0-9, ]+)\)/i))?i[1].split(/\s*,\s*/).map((t=>parseInt(t))):[0,0,0];Ft[t]=e}return e.slice()}const Ft={black:[0,0,0],navy:[0,0,128],darkblue:[0,0,139],mediumblue:[0,0,205],blue:[0,0,255],darkgreen:[0,100,0],green:[0,128,0],teal:[0,128,128],darkcyan:[0,139,139],deepskyblue:[0,191,255],darkturquoise:[0,206,209],mediumspringgreen:[0,250,154],lime:[0,255,0],springgreen:[0,255,127],aqua:[0,255,255],cyan:[0,255,255],midnightblue:[25,25,112],dodgerblue:[30,144,255],forestgreen:[34,139,34],seagreen:[46,139,87],darkslategray:[47,79,79],darkslategrey:[47,79,79],limegreen:[50,205,50],mediumseagreen:[60,179,113],turquoise:[64,224,208],royalblue:[65,105,225],steelblue:[70,130,180],darkslateblue:[72,61,139],mediumturquoise:[72,209,204],indigo:[75,0,130],darkolivegreen:[85,107,47],cadetblue:[95,158,160],cornflowerblue:[100,149,237],mediumaquamarine:[102,205,170],dimgray:[105,105,105],dimgrey:[105,105,105],slateblue:[106,90,205],olivedrab:[107,142,35],slategray:[112,128,144],slategrey:[112,128,144],lightslategray:[119,136,153],lightslategrey:[119,136,153],mediumslateblue:[123,104,238],lawngreen:[124,252,0],chartreuse:[127,255,0],aquamarine:[127,255,212],maroon:[128,0,0],purple:[128,0,128],olive:[128,128,0],gray:[128,128,128],grey:[128,128,128],skyblue:[135,206,235],lightskyblue:[135,206,250],blueviolet:[138,43,226],darkred:[139,0,0],darkmagenta:[139,0,139],saddlebrown:[139,69,19],darkseagreen:[143,188,143],lightgreen:[144,238,144],mediumpurple:[147,112,216],darkviolet:[148,0,211],palegreen:[152,251,152],darkorchid:[153,50,204],yellowgreen:[154,205,50],sienna:[160,82,45],brown:[165,42,42],darkgray:[169,169,169],darkgrey:[169,169,169],lightblue:[173,216,230],greenyellow:[173,255,47],paleturquoise:[175,238,238],lightsteelblue:[176,196,222],powderblue:[176,224,230],firebrick:[178,34,34],darkgoldenrod:[184,134,11],mediumorchid:[186,85,211],rosybrown:[188,143,143],darkkhaki:[189,183,107],silver:[192,192,192],mediumvioletred:[199,21,133],indianred:[205,92,92],peru:[205,133,63],chocolate:[210,105,30],tan:[210,180,140],lightgray:[211,211,211],lightgrey:[211,211,211],palevioletred:[216,112,147],thistle:[216,191,216],orchid:[218,112,214],goldenrod:[218,165,32],crimson:[220,20,60],gainsboro:[220,220,220],plum:[221,160,221],burlywood:[222,184,135],lightcyan:[224,255,255],lavender:[230,230,250],darksalmon:[233,150,122],violet:[238,130,238],palegoldenrod:[238,232,170],lightcoral:[240,128,128],khaki:[240,230,140],aliceblue:[240,248,255],honeydew:[240,255,240],azure:[240,255,255],sandybrown:[244,164,96],wheat:[245,222,179],beige:[245,245,220],whitesmoke:[245,245,245],mintcream:[245,255,250],ghostwhite:[248,248,255],salmon:[250,128,114],antiquewhite:[250,235,215],linen:[250,240,230],lightgoldenrodyellow:[250,250,210],oldlace:[253,245,230],red:[255,0,0],fuchsia:[255,0,255],magenta:[255,0,255],deeppink:[255,20,147],orangered:[255,69,0],tomato:[255,99,71],hotpink:[255,105,180],coral:[255,127,80],darkorange:[255,140,0],lightsalmon:[255,160,122],orange:[255,165,0],lightpink:[255,182,193],pink:[255,192,203],gold:[255,215,0],peachpuff:[255,218,185],navajowhite:[255,222,173],moccasin:[255,228,181],bisque:[255,228,196],mistyrose:[255,228,225],blanchedalmond:[255,235,205],papayawhip:[255,239,213],lavenderblush:[255,240,245],seashell:[255,245,238],cornsilk:[255,248,220],lemonchiffon:[255,250,205],floralwhite:[255,250,240],snow:[255,250,250],yellow:[255,255,0],lightyellow:[255,255,224],ivory:[255,255,240],white:[255,255,255]};class Bt extends Rt{constructor(){super(),this._uniforms={};try{this._gl=this._initWebGL()}catch(t){alert(t.message)}}static isSupported(){return!!document.createElement("canvas").getContext("webgl2",{preserveDrawingBuffer:!0})}schedule(t){requestAnimationFrame(t)}getContainer(){return this._gl.canvas}setOptions(t){super.setOptions(t),this._updateSize();let e=this._options.tileSet;e&&"complete"in e&&!e.complete?e.addEventListener("load",(()=>this._updateTexture(e))):this._updateTexture(e)}draw(t,e){const i=this._gl,s=this._options;let[n,o,r,a,l]=t,h=i.canvas.height-(o+1)*s.tileHeight;if(i.scissor(n*s.tileWidth,h,s.tileWidth,s.tileHeight),e&&(s.tileColorize?i.clearColor(0,0,0,0):i.clearColor(...Yt(l)),i.clear(i.COLOR_BUFFER_BIT)),!r)return;let c=[].concat(r),u=[].concat(l),d=[].concat(a);i.uniform2fv(this._uniforms.targetPosRel,[n,o]);for(let t=0;t<c.length;t++){let e=this._options.tileMap[c[t]];if(!e)throw new Error(`Char "${c[t]}" not found in tileMap`);i.uniform1f(this._uniforms.colorize,s.tileColorize?1:0),i.uniform2fv(this._uniforms.tilesetPosAbs,e),s.tileColorize&&(i.uniform4fv(this._uniforms.tint,Yt(d[t])),i.uniform4fv(this._uniforms.bg,Yt(u[t]))),i.drawArrays(i.TRIANGLE_STRIP,0,4)}}clear(){const t=this._gl;t.clearColor(...Yt(this._options.bg)),t.scissor(0,0,t.canvas.width,t.canvas.height),t.clear(t.COLOR_BUFFER_BIT)}computeSize(t,e){return[Math.floor(t/this._options.tileWidth),Math.floor(e/this._options.tileHeight)]}computeFontSize(){throw new Error("Tile backend does not understand font size")}eventToPosition(t,e){let i=this._gl.canvas,s=i.getBoundingClientRect();return t-=s.left,e-=s.top,t*=i.width/s.width,e*=i.height/s.height,t<0||e<0||t>=i.width||e>=i.height?[-1,-1]:this._normalizedEventToPosition(t,e)}_initWebGL(){let t=document.createElement("canvas").getContext("webgl2",{preserveDrawingBuffer:!0});window.gl=t;let e=function(t,e,i){const s=t.createShader(t.VERTEX_SHADER);if(t.shaderSource(s,e),t.compileShader(s),!t.getShaderParameter(s,t.COMPILE_STATUS))throw new Error(t.getShaderInfoLog(s)||"");const n=t.createShader(t.FRAGMENT_SHADER);if(t.shaderSource(n,i),t.compileShader(n),!t.getShaderParameter(n,t.COMPILE_STATUS))throw new Error(t.getShaderInfoLog(n)||"");const o=t.createProgram();if(t.attachShader(o,s),t.attachShader(o,n),t.linkProgram(o),!t.getProgramParameter(o,t.LINK_STATUS))throw new Error(t.getProgramInfoLog(o)||"");return o}(t,qt,Nt);return t.useProgram(e),function(t){const e=new Float32Array([0,0,1,0,0,1,1,1]),i=t.createBuffer();t.bindBuffer(t.ARRAY_BUFFER,i),t.bufferData(t.ARRAY_BUFFER,e,t.STATIC_DRAW),t.enableVertexAttribArray(0),t.vertexAttribPointer(0,2,t.FLOAT,!1,0,0)}(t),Lt.forEach((i=>this._uniforms[i]=t.getUniformLocation(e,i))),this._program=e,t.enable(t.BLEND),t.blendFuncSeparate(t.SRC_ALPHA,t.ONE_MINUS_SRC_ALPHA,t.ONE,t.ONE_MINUS_SRC_ALPHA),t.enable(t.SCISSOR_TEST),t}_normalizedEventToPosition(t,e){return[Math.floor(t/this._options.tileWidth),Math.floor(e/this._options.tileHeight)]}_updateSize(){const t=this._gl,e=this._options,i=[e.width*e.tileWidth,e.height*e.tileHeight];t.canvas.width=i[0],t.canvas.height=i[1],t.viewport(0,0,i[0],i[1]),t.uniform2fv(this._uniforms.tileSize,[e.tileWidth,e.tileHeight]),t.uniform2fv(this._uniforms.targetSize,i)}_updateTexture(t){!function(t,e){let i=t.createTexture();t.bindTexture(t.TEXTURE_2D,i),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,t.NEAREST),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.NEAREST),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.REPEAT),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.REPEAT),t.pixelStorei(t.UNPACK_FLIP_Y_WEBGL,0),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,e)}(this._gl,t)}}const Lt=["targetPosRel","tilesetPosAbs","tileSize","targetSize","colorize","bg","tint"],qt="\n#version 300 es\n\nin vec2 tilePosRel;\nout vec2 tilesetPosPx;\n\nuniform vec2 tilesetPosAbs;\nuniform vec2 tileSize;\nuniform vec2 targetSize;\nuniform vec2 targetPosRel;\n\nvoid main() {\n\tvec2 targetPosPx = (targetPosRel + tilePosRel) * tileSize;\n\tvec2 targetPosNdc = ((targetPosPx / targetSize)-0.5)*2.0;\n\ttargetPosNdc.y *= -1.0;\n\n\tgl_Position = vec4(targetPosNdc, 0.0, 1.0);\n\ttilesetPosPx = tilesetPosAbs + tilePosRel * tileSize;\n}".trim(),Nt="\n#version 300 es\nprecision highp float;\n\nin vec2 tilesetPosPx;\nout vec4 fragColor;\nuniform sampler2D image;\nuniform bool colorize;\nuniform vec4 bg;\nuniform vec4 tint;\n\nvoid main() {\n\tfragColor = vec4(0, 0, 0, 1);\n\n\tvec4 texel = texelFetch(image, ivec2(tilesetPosPx), 0);\n\n\tif (colorize) {\n\t\ttexel.rgb = tint.a * tint.rgb + (1.0-tint.a) * texel.rgb;\n\t\tfragColor.rgb = texel.a*texel.rgb + (1.0-texel.a)*bg.rgb;\n\t\tfragColor.a = texel.a + (1.0-texel.a)*bg.a;\n\t} else {\n\t\tfragColor = texel;\n\t}\n}".trim();let Wt={};function Yt(t){if(!(t in Wt)){let e;if("transparent"==t)e=[0,0,0,0];else if(t.indexOf("rgba")>-1){e=(t.match(/[\d.]+/g)||[]).map(Number);for(let t=0;t<3;t++)e[t]=e[t]/255}else e=Xt(t).map((t=>t/255)),e.push(1);Wt[t]=e}return Wt[t]}function $t(t){const e=6/256;let i=Xt(t);return 36*Math.floor(i[0]*e)+6*Math.floor(i[1]*e)+1*Math.floor(i[2]*e)+16}class jt extends Rt{constructor(){super(),this._offset=[0,0],this._cursor=[-1,-1],this._lastColor=""}schedule(t){setTimeout(t,1e3/60)}setOptions(t){super.setOptions(t);let e=[t.width,t.height],i=this.computeSize();this._offset=i.map(((t,i)=>Math.floor((t-e[i])/2)))}clear(){process.stdout.write(`[0;48;5;${$t(this._options.bg)}m[2J`)}draw(t,e){let[i,s,n,o,r]=t,a=this._offset[0]+i,l=this._offset[1]+s,h=this.computeSize();if(a<0||a>=h[0])return;if(l<0||l>=h[1])return;if(a===this._cursor[0]&&l===this._cursor[1]||(process.stdout.write(function(t,e){return`[${e+1};${t+1}H`}(a,l)),this._cursor[0]=a,this._cursor[1]=l),e&&(n||(n=" ")),!n)return;let c=function(t,e){return`[0;38;5;${$t(t)};48;5;${$t(e)}m`}(o,r);if(c!==this._lastColor&&(process.stdout.write(c),this._lastColor=c),"\t"!=n){let t=[].concat(n);process.stdout.write(t[0])}this._cursor[0]++,this._cursor[0]>=h[0]&&(this._cursor[0]=0,this._cursor[1]++)}computeFontSize(){throw new Error("Terminal backend has no notion of font size")}eventToPosition(t,e){return[t,e]}computeSize(){return[process.stdout.columns,process.stdout.rows]}}const Dt=/%([bc]){([^}]*)}/g;function Ht(t,e){let i=[],s=0;t.replace(Dt,(function(e,n,o,r){let a=t.substring(s,r);return a.length&&i.push({type:0,value:a}),i.push({type:"c"==n?2:3,value:o.trim()}),s=r+e.length,""}));let n=t.substring(s);return n.length&&i.push({type:0,value:n}),function(t,e){e||(e=1/0);let i=0,s=0,n=-1;for(;i<t.length;){let o=t[i];if(1==o.type&&(s=0,n=-1),0!=o.type){i++;continue}for(;0==s&&" "==o.value.charAt(0);)o.value=o.value.substring(1);let r=o.value.indexOf("\n");if(-1!=r){o.value=Gt(t,i,r,!0);let e=o.value.split("");for(;e.length&&" "==e[e.length-1];)e.pop();o.value=e.join("")}if(o.value.length){if(s+o.value.length>e){let r=-1;for(;;){let t=o.value.indexOf(" ",r+1);if(-1==t)break;if(s+t>e)break;r=t}if(-1!=r)o.value=Gt(t,i,r,!0);else if(-1!=n){let e=t[n],s=e.value.lastIndexOf(" ");e.value=Gt(t,n,s,!0),i=n}else o.value=Gt(t,i,e-s,!1)}else s+=o.value.length,-1!=o.value.indexOf(" ")&&(n=i);i++}else t.splice(i,1)}t.push({type:1});let o=null;for(let e=0;e<t.length;e++){let i=t[e];switch(i.type){case 0:o=i;break;case 1:if(o){let t=o.value.split("");for(;t.length&&" "==t[t.length-1];)t.pop();o.value=t.join("")}o=null}}return t.pop(),t}(i,e)}function Gt(t,e,i,s){let n={type:1},o={type:0,value:t[e].value.substring(i+(s?1:0))};return t.splice(e+1,0,n,o),t[e].value.substring(0,i)}const Vt=65,Qt=68,Jt=83,Kt=87,Zt={hex:Ot,rect:It,tile:Ut,"tile-gl":Bt,term:jt},te={width:80,height:25,transpose:!1,layout:"rect",fontSize:15,spacing:1,border:0,forceSquareRatio:!1,fontFamily:"monospace",fontStyle:"",fg:"#ccc",bg:"#000",tileWidth:32,tileHeight:32,tileMap:{},tileSet:null,tileColorize:!1};let ee=(()=>{class t{constructor(t={}){this._data={},this._dirty=!1,this._options={},t=Object.assign({},te,t),this.setOptions(t),this.DEBUG=this.DEBUG.bind(this),this._tick=this._tick.bind(this),this._backend.schedule(this._tick)}DEBUG(t,e,i){let s=[this._options.bg,this._options.fg];this.draw(t,e,null,null,s[i%s.length])}clear(){this._data={},this._dirty=!0}setOptions(t){if(Object.assign(this._options,t),t.width||t.height||t.fontSize||t.fontFamily||t.spacing||t.layout){if(t.layout){let e=Zt[t.layout];this._backend=new e}this._backend.setOptions(this._options),this._dirty=!0}return this}getOptions(){return this._options}getContainer(){return this._backend.getContainer()}computeSize(t,e){return this._backend.computeSize(t,e)}computeFontSize(t,e){return this._backend.computeFontSize(t,e)}computeTileSize(t,e){return[Math.floor(t/this._options.width),Math.floor(e/this._options.height)]}eventToPosition(t){let e,i;return"touches"in t?(e=t.touches[0].clientX,i=t.touches[0].clientY):(e=t.clientX,i=t.clientY),this._backend.eventToPosition(e,i)}draw(t,e,i,s,n){s||(s=this._options.fg),n||(n=this._options.bg);let o=`${t},${e}`;this._data[o]=[t,e,i,s,n],!0!==this._dirty&&(this._dirty||(this._dirty={}),this._dirty[o]=!0)}drawOver(t,e,i,s,n){const o=`${t},${e}`,r=this._data[o];r?(r[2]=i||r[2],r[3]=s||r[3],r[4]=n||r[4]):this.draw(t,e,i,s,n)}drawText(t,e,i,s){let n=null,o=null,r=t,a=e,l=1;s||(s=this._options.width-t);let h=Ht(i,s);for(;h.length;){let e=h.shift();switch(e.type){case 0:let i=!1,s=!1,h=!1,c=!1;for(let t=0;t<e.value.length;t++){let l=e.value.charCodeAt(t),u=e.value.charAt(t);if("term"===this._options.layout){let t=l>>8;if(17===t||t>=46&&t<=159||t>=172&&t<=215||l>=43360&&l<=43391){this.draw(r+0,a,u,n,o),this.draw(r+1,a,"\t",n,o),r+=2;continue}}h=l>65280&&l<65377||l>65500&&l<65512||l>65518,i=32==u.charCodeAt(0)||12288==u.charCodeAt(0),!c||h||i||r++,h&&!s&&r++,this.draw(r++,a,u,n,o),s=i,c=h}break;case 2:n=e.value||null;break;case 3:o=e.value||null;break;case 1:r=t,a++,l++}}return l}_tick(){if(this._backend.schedule(this._tick),this._dirty){if(!0===this._dirty){this._backend.clear();for(let t in this._data)this._draw(t,!1)}else for(let t in this._dirty)this._draw(t,!0);this._dirty=!1}}_draw(t,e){let i=this._data[t];i[4]!=this._options.bg&&(e=!0),this._backend.draw(i,e)}}return t.Rect=It,t.Hex=Ot,t.Tile=Ut,t.TileGL=Bt,t.Term=jt,t})();const ie=.5*(Math.sqrt(3)-1),se=(3-Math.sqrt(3))/6;var ne={Simplex:class extends class{}{constructor(t=256){super(),this._gradients=[[0,-1],[1,-1],[1,0],[1,1],[0,1],[-1,1],[-1,0],[-1,-1]];let e=[];for(let i=0;i<t;i++)e.push(i);e=Ct.shuffle(e),this._perms=[],this._indexes=[];for(let i=0;i<2*t;i++)this._perms.push(e[i%t]),this._indexes.push(this._perms[i]%this._gradients.length)}get(t,e){let i,s,n,o=this._perms,r=this._indexes,a=o.length/2,l=0,h=0,c=0,u=(t+e)*ie,d=Math.floor(t+u),f=Math.floor(e+u),g=(d+f)*se,p=t-(d-g),_=e-(f-g);p>_?(s=1,n=0):(s=0,n=1);let m=p-s+se,y=_-n+se,b=p-1+2*se,w=_-1+2*se,S=zt(d,a),v=zt(f,a),x=.5-p*p-_*_;if(x>=0){x*=x,i=r[S+o[v]];let t=this._gradients[i];l=x*x*(t[0]*p+t[1]*_)}let E=.5-m*m-y*y;if(E>=0){E*=E,i=r[S+s+o[v+n]];let t=this._gradients[i];h=E*E*(t[0]*m+t[1]*y)}let T=.5-b*b-w*w;if(T>=0){T*=T,i=r[S+1+o[v+1]];let t=this._gradients[i];c=T*T*(t[0]*b+t[1]*w)}return 70*(l+h+c)}}};const oe=at({val:St.f32});var re;!function(t){t[t.Water=0]="Water",t[t.Plain=1]="Plain",t[t.Forest=2]="Forest",t[t.Thicket=3]="Thicket"}(re||(re={}));const ae=at({tile:St.ui8}),le=at(),he=new Map,ce=at(),ue=new ee({width:60,height:40,fontSize:15,forceSquareRatio:!0}),de=K([vt]),fe=K([ce]),ge=K([Mt]),pe=(_e=ge,t=>{t[H].has(_e)||Q(t,_e);const e=t[H].get(_e),i=e.entered.dense.slice();return e.entered=C(),i});var _e;const me={};me[Kt]=0,me[Jt]=1,me[Qt]=2,me[Vt]=3;const ye=Math.sqrt(1.05*.05)-.05,be=/^(?:[0-9a-f]{3}){1,2}$/i,we={black:"#000000",white:"#ffffff",threshold:ye};function Se(t){if("#"===t.slice(0,1)&&(t=t.slice(1)),!be.test(t))throw new Error(`Invalid HEX color: "${t}"`);return 3===t.length&&(t=t[0]+t[0]+t[1]+t[1]+t[2]+t[2]),[parseInt(t.slice(0,2),16),parseInt(t.slice(2,4),16),parseInt(t.slice(4,6),16)]}function ve(t){if(!t)throw new Error("Invalid color value");return Array.isArray(t)?t:"string"==typeof t?Se(t):[t.r,t.g,t.b]}function xe(t,e,i){const s=!0===e?we:Object.assign({},we,e);return function(t){let e,i;const s=[];for(e=0;e<t.length;e++)i=t[e]/255,s[e]=i<=.03928?i/12.92:Math.pow((i+.055)/1.055,2.4);return.2126*s[0]+.7152*s[1]+.0722*s[2]}(t)>s.threshold?i?Se(s.black):s.black:i?Se(s.white):s.white}function Ee(t,e=!1){return t=ve(t),e?xe(t,e):"#"+t.map((t=>function(t,e=2){return(new Array(e).join("0")+t).slice(-e)}((255-t).toString(16)))).join("")}!function(t){function e(t,e){t=ve(t);const i=e?xe(t,e,!0):t.map((t=>255-t));return{r:(s=i)[0],g:s[1],b:s[2]};var s}t.asRGB=e,t.asRgbArray=function(t,e){return t=ve(t),e?xe(t,e,!0):t.map((t=>255-t))},t.defaultThreshold=ye,t.asRgbObject=e}(Ee||(Ee={}));var Te=Ee;document.body.appendChild(ue.getContainer());const Me=((...t)=>e=>{let i=e;for(let e=0;e<t.length;e++){i=(0,t[e])(i)}return i})((t=>{const e=pe(t);for(let i=0;i<e.length;i++)window.addEventListener("keydown",(function(e){const i=e.keyCode;if(i in me){const e=de(t)[0];0===me[i]&&xt.y[e]>0&&(xt.y[e]=xt.y[e]-1),1===me[i]&&xt.y[e]<0&&(xt.y[e]=xt.y[e]+1),2===me[i]&&xt.x[e]<0&&(xt.x[e]=xt.x[e]+1),3===me[i]&&xt.x[e]>0&&(xt.x[e]=xt.x[e]-1)}}));return t}),(t=>{const e=de(t);for(let t=0;t<e.length;t++)ue.drawText(0,38,"Hello World.",60),ue.drawText(0,39,"WASD to move. Left click to select tile.",60);return t}),(t=>{const e=de(t),i=xt.x[e[0]],s=xt.y[e[0]];for(let e=0;e<20;e++)for(let n=0;n<30;n++){const o=he.get(`${i+n},${s+e}`),r=xt.x[o],a=xt.y[o],l="",h="";let c="";const u=ae.tile[o];u===re.Water?c="#5b6ee1":u===re.Plain?c="#99e550":u===re.Forest?c="#37946e":u===re.Thicket&&(c="#1a6a49"),fe(t).includes(o)&&(c=Te(c)),ue.draw(r-i+Et,a-s+Tt,l,h,c)}return t})),ke=((...t)=>{const e="object"==typeof t[0]?t[0]:{},i="number"==typeof t[0]?t[0]:"number"==typeof t[1]?t[1]:F();return wt(e,i),yt.push(e),e})();(t=>{const e=N(t);ct(t,Mt,e)})(ke),(t=>{const e=N(t);ct(t,vt,e),ct(t,xt,e),xt.x[e]=Math.floor(0),xt.y[e]=Math.floor(0)})(ke),(t=>{const e=new ne.Simplex;for(let i=0;i<20;i++)for(let s=0;s<30;s++){const n=N(t);he.set(`${s},${i}`,n),ct(t,le,n),ct(t,xt,n),xt.x[n]=s,xt.y[n]=i;const o=e.get(s/20,i/20);ct(t,oe,n),oe.val[n]=o,ct(t,ae,n),o<-.5?ae.tile[n]=re.Water:o<.5?ae.tile[n]=re.Plain:o<.8?ae.tile[n]=re.Forest:o<1&&(ae.tile[n]=re.Thicket)}})(ke),(t=>{window.addEventListener("mouseup",(e=>{const i=ue.eventToPosition(e)[0],s=ue.eventToPosition(e)[1],n=de(t),o=xt.x[n[0]],r=xt.y[n[0]],a=i-Et+o,l=s-Tt+r,h=he.get(`${a},${l}`),c=fe(t);for(let e=0;e<c.length;e++){const i=c[e];ut(t,ce,i)}ct(t,ce,h)}))})(ke),setInterval((()=>{Me(ke)}),16)}();
